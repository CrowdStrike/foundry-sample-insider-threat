name: Remove leavers from watchlist and AD group
description: Get leavers data from workday and remove from Identity protection watchlist and AD group after 30 days of their departure
parameters:
    actions:
        configuration:
            _workday_generate_access_token_6053a64e:
                properties:
                    params.path.workday_tenant:
                        required: true
                    x-www-form-urlencoded.refresh_token:
                        required: false
            active_directory___remove_from_group_1835cbca:
                properties:
                    group_guid:
                        required: true
                        default_value: 8dd426bb-f6d9-40bd-8173-641a79952616
            active_directory___remove_from_group_c0d58f6e:
                properties:
                    group_guid:
                        required: true
                        default_value: 8dd426bb-f6d9-40bd-8173-641a79952616
            workday_get_leavers_data_ab5fcb51:
                properties:
                    params.path.workday_tenant:
                        required: true
provision_on_install: true
trigger:
    next:
        - _workday_generate_access_token_6053a64e
    event: Schedule
    schedule:
        time_cycle: 0 5 */1 * *
        start_date: ""
        end_date: ""
        tz: Etc/UTC
        skip_concurrent: false
actions:
    _workday_generate_access_token_6053a64e:
        next:
            - workday_get_leavers_data_ab5fcb51
        id: api_integrations.Workday generate access token.Generate access token
        properties:
            x-www-form-urlencoded:
                grant_type: refresh_token
    workday_get_leavers_data_ab5fcb51:
        next:
            - activity_ab5fcb51_9e18_41dc_9ac1_af1e4adf938b_api_integration_custom_workday_get_leavers_data_workday_get_leavers_data_body_data_0f6d7f85
        id: api_integrations.Workday get leavers data.Get leavers data
        properties:
            params:
                header:
                    authorization: ${_workday_generate_access_token_6053a64e.API_Integration.Custom_Workday_generate_access_token._Workday_generate_access_token.body.token_type} ${_workday_generate_access_token_6053a64e.API_Integration.Custom_Workday_generate_access_token._Workday_generate_access_token.body.access_token}
                path:
                    workday_tenant-param: true
                query:
                    query: SELECT hireDate, preferredName as employee_name, email_PrimaryWork as employee_email, employeeID, lastDayOfWork, worker, terminationDate1 FROM allActiveAndTerminatedWorkers WHERE terminationDate1 = '${cs.timestamp.format(cs.timestamp.now() - duration('720h'), '2006-01-02')}'
loops:
    ? activity_ab5fcb51_9e18_41dc_9ac1_af1e4adf938b_api_integration_custom_workday_get_leavers_data_workday_get_leavers_data_body_data_0f6d7f85
    :   display: For each Data; Concurrently
        for:
            input: workday_get_leavers_data_ab5fcb51.API_Integration.Custom_Workday_get_leavers_data.Workday_get_leavers_data.body.data
            continue_on_partial_execution: true
            sequential: false
        trigger:
            next:
                - get_user_identity_context_0c7300ec
        actions:
            active_directory___remove_from_group_1835cbca:
                id: 8ecb53650a273d22032941d47320acb4
                properties:
                    domain: ${get_user_identity_context_0c7300ec.Enrich.User.Domain}
                    note: Remove departed employee from Active Directory group
                    object_guid: ${get_user_identity_context_0c7300ec.Enrich.User.EntityGUID}
            get_associated_linked_accounts_756f1de4:
                next:
                    - activity_756f1de4_e9b5_474b_a39e_458d39710c10_faas_identity_context_getassociatedlinkedaccounts_linked_entities_a7e36ac7
                id: functions.identity-context.Get associated linked accounts
                properties:
                    EntityId: ${get_user_identity_context_0c7300ec.Enrich.User.EntityGUID}
            get_user_identity_context_0c7300ec:
                next:
                    - FROM_gateway_condition_FROM_gateway_condition_FROM_gateway_condition_FROM_gateway_condition_FROM_gateway_condition_FROM_gateway_condition_user_ad_email_exists_32b658ae_TO_gateway_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_condition_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_condition_FROM_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4
                id: 19c7e2af0a24f468be7797fe180c8329
                properties:
                    continue_if_entity_not_found: true
                    email: ${workday_get_leavers_data_ab5fcb51.API_Integration.Custom_Workday_get_leavers_data.Workday_get_leavers_data.body.data.#.employee_email}
            remove_user_from_watchlist_e9829c62:
                id: 844dcff30c42cba24e501be8a6cf2577
                properties:
                    note: Removed from the watchlist as a Departing employee
                    user_id: ${get_user_identity_context_0c7300ec.Enrich.User.EntitySid}
            write_to_log_repo_ce465981:
                id: 0ec68880256f6192b9abef766d31fb04
                properties:
                    custom_json:
                        employeeEmail: ${get_user_identity_context_0c7300ec.Enrich.User.Email}
                        employeeGUID: ${get_user_identity_context_0c7300ec.Enrich.User.EntityGUID}
                        employeeName: ${get_user_identity_context_0c7300ec.Enrich.User.EntityName}
                        warn: Not removing user from watchlist and AD group as employee account is 'cloud_only'
                    foundry_app_id: ${{FOUNDRY_APP_ID}}
            write_to_log_repo_cf08a843:
                id: 0ec68880256f6192b9abef766d31fb04
                properties:
                    _fields:
                        - ${workday_get_leavers_data_ab5fcb51.API_Integration.Custom_Workday_get_leavers_data.Workday_get_leavers_data.body.data.#}
                    custom_json:
                        employeeEmail: ${workday_get_leavers_data_ab5fcb51.API_Integration.Custom_Workday_get_leavers_data.Workday_get_leavers_data.body.data.#.employee_email}
                        employeeID: ${workday_get_leavers_data_ab5fcb51.API_Integration.Custom_Workday_get_leavers_data.Workday_get_leavers_data.body.data.#.employeeID}
                        warn: Employee with emaiId '${workday_get_leavers_data_ab5fcb51.API_Integration.Custom_Workday_get_leavers_data.Workday_get_leavers_data.body.data.#.employee_email}' not exists in Identity Protection
                    foundry_app_id: ${{FOUNDRY_APP_ID}}
        conditions:
            ? FROM_FROM_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4
            :   next:
                    - active_directory___remove_from_group_1835cbca
                    - remove_user_from_watchlist_e9829c62
                    - get_associated_linked_accounts_756f1de4
                expression: get_user_identity_context_0c7300ec.Enrich.User.EntitySid:!null+get_user_identity_context_0c7300ec.Enrich.User.UserEntraObjectID:null
                display:
                    - User object SID exists
                    - User Entra Object ID does not exist
                else:
                    - write_to_log_repo_ce465981
            ? FROM_gateway_condition_FROM_gateway_condition_FROM_gateway_condition_FROM_gateway_condition_FROM_gateway_condition_FROM_gateway_condition_user_ad_email_exists_32b658ae_TO_gateway_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_condition_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_condition_FROM_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4
            :   next:
                    - FROM_FROM_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_FROM_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4_TO_gateway_parallel_condition_user_object_sid_exists_user_entra_object_id_does_not_exist_2e4067a4
                expression: get_user_identity_context_0c7300ec.Enrich.User.Email:!null
                display:
                    - User AD email exists
                else:
                    - write_to_log_repo_cf08a843
        loops:
            activity_756f1de4_e9b5_474b_a39e_458d39710c10_faas_identity_context_getassociatedlinkedaccounts_linked_entities_a7e36ac7:
                display: For each Linked accounts; Concurrently
                for:
                    input: get_associated_linked_accounts_756f1de4.FaaS.identity-context.Getassociatedlinkedaccounts.linked_entities
                    continue_on_partial_execution: false
                    sequential: false
                trigger:
                    next:
                        - user_object_sid_instance_exists_ad_domain_instance_exists_user_object_guid_instance_exists_035a5b44
                actions:
                    active_directory___remove_from_group_c0d58f6e:
                        id: 8ecb53650a273d22032941d47320acb4
                        properties:
                            domain: ${get_associated_linked_accounts_756f1de4.FaaS.identity-context.Getassociatedlinkedaccounts.linked_entities.#.Domain}
                            object_guid: ${get_associated_linked_accounts_756f1de4.FaaS.identity-context.Getassociatedlinkedaccounts.linked_entities.#.EntityId}
                    remove_user_from_watchlist_76b9849a:
                        id: 844dcff30c42cba24e501be8a6cf2577
                        properties:
                            user_id: ${get_associated_linked_accounts_756f1de4.FaaS.identity-context.Getassociatedlinkedaccounts.linked_entities.#.EntitySid}
                conditions:
                    user_object_sid_instance_exists_ad_domain_instance_exists_user_object_guid_instance_exists_035a5b44:
                        next:
                            - remove_user_from_watchlist_76b9849a
                            - active_directory___remove_from_group_c0d58f6e
                        expression: get_associated_linked_accounts_756f1de4.FaaS.identity-context.Getassociatedlinkedaccounts.linked_entities.#.EntitySid:!null+get_associated_linked_accounts_756f1de4.FaaS.identity-context.Getassociatedlinkedaccounts.linked_entities.#.Domain:!null+get_associated_linked_accounts_756f1de4.FaaS.identity-context.Getassociatedlinkedaccounts.linked_entities.#.EntityId:!null
                        display:
                            - User object SID instance exists
                            - AD Domain instance exists
                            - User object GUID instance exists
